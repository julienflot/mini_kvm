cmake_minimum_required(VERSION 4.0)

function(define_scenario exec name args regex)
    add_test(NAME ${exec}.${name} COMMAND ${exec} ${args})
    set_property(TEST ${exec}.${name} PROPERTY PASS_REGULAR_EXPRESSION ${regex})
endfunction()

define_test(run_args)
define_scenario(run_args vcpu "-v1" "vcpu=1")
define_scenario(run_args vcpu_long "--vcpu=1" "vcpu=1")
define_scenario(run_args mem "-m4096" "mem_size=4096")
define_scenario(run_args mem_long "--mem=4096" "mem_size=4096")
define_scenario(run_args mem_k "-m4096K" "mem_size=4096000")
define_scenario(run_args mem_long_k "--mem=4096K" "mem_size=4096000")
define_scenario(run_args mem_m "-m4096M" "mem_size=4096000000")
define_scenario(run_args mem_long_m "--mem=4096M" "mem_size=4096000000")
define_scenario(run_args mem_g "-m4096G" "mem_size=4096000000000")
define_scenario(run_args mem_long_g "--mem=4096G" "mem_size=4096000000000")
define_scenario(run_args log "-l" "log_enabled=1")
define_scenario(run_args name "-ntest_vm" "name=test_vm")
define_scenario(run_args name_long "--name=test_vm" "name=test_vm")
